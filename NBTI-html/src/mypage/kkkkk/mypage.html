<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>마이페이지 - 검사 결과 조회</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard@1.3.8/dist/web/static/pretendard.css" />
  <link rel="stylesheet" href="shared-mypage.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- 상단 네비게이션 -->
<header class="header">
  <div class="logo">두뇌 트레이닝</div>
  <nav class="menu" aria-label="메인 메뉴">
    <a href="test_study.html">검사 및 학습</a>
    <a href="mypage.html" aria-current="page">마이페이지</a>
    <a href="#">로그아웃</a>
  </nav>
</header>

<!-- 레이아웃 -->
<div class="layout">
  <!-- 좌측 사이드바 -->
  <aside class="sidebar">
    <h3>마이페이지</h3>
    <a href="mypage.html" class="active" aria-current="page">검사 결과 및 통계</a>
    <a href="study_list.html">학습 결과 내역</a>
    <a href="objection_list.html">이의제기 내역</a>
    <a href="userinfo.html">개인정보 조회</a>
  </aside>

  <!-- 본문 영역 -->
  <main class="content">
    <!-- 📊 최근 검사 결과 -->
    <section class="section">
      <h2 class="section-title">최근 검사 결과</h2>

      <div class="chart-row">
        <div class="chart-box radar">
          <canvas id="radarChart" aria-label="영역별 점수 레이더 차트" role="img"></canvas>
        </div>
        <div class="chart-box line">
          <canvas id="lineChart" aria-label="총점 추이 선형 차트" role="img"></canvas>
        </div>
      </div>

      <!-- 세부 영역 점수 -->
        <div class="grid">
          <div class="grid-item">
            <div class="score-header">
              <div class="category-title">언어 이해</div>
              <div class="score-num">6점</div>
            </div>
            <div class="score-bar"><div class="bar" style="width: 100%"></div></div>
            <div class="category-content">단어와 문장을 정확하게 해석하고 의미를 파악하는 능력</div>
          </div>
          <div class="grid-item">
            <div class="score-header">
              <div class="category-title">시사 상식</div>
              <div class="score-num">5점</div>
            </div>
            <div class="score-bar"><div class="bar" style="width: 83.3%"></div></div>
            <div class="category-content">다양한 분야의 기본적인 배경 지식과 사회적 이해도</div>
          </div>
          <div class="grid-item">
            <div class="score-header">
              <div class="category-title">지각 추론</div>
              <div class="score-num">1점</div>
            </div>
            <div class="score-bar"><div class="bar" style="width: 16.6%"></div></div>
            <div class="category-content">복잡한 시각 정보를 분석하고 규칙을 찾아내는 능력</div>
          </div>
          <div class="grid-item">
            <div class="score-header">
              <div class="category-title">공간 지각력</div>
              <div class="score-num">6점</div>
            </div>
            <div class="score-bar"><div class="bar" style="width: 100%"></div></div>
            <div class="category-content">공간의 형태와 관계를 파악하고 시각적으로 변형하는 능력</div>
          </div>
          <div class="grid-item">
            <div class="score-header">
              <div class="category-title">작업 기억</div>
              <div class="score-num">4점</div>
            </div>
            <div class="score-bar"><div class="bar" style="width: 66.6%"></div></div>
            <div class="category-content">정보를 일시적으로 저장하고 동시에 조작할 수 있는 능력</div>
          </div>
          <div class="grid-item">
            <div class="score-header">
              <div class="category-title">처리 속도</div>
              <div class="score-num">5점</div>
            </div>
            <div class="score-bar"><div class="bar" style="width: 83.3%"></div></div>
            <div class="category-content">주어진 과제를 빠르고 정확하게 수행하는 능력</div>
          </div>
        </div>

        <!-- AI 요약 -->
        <div class="ai-summary-card" aria-label="AI 분석 요약">
          <p><strong>AI 분석 결과:</strong></p>
          <p>지각 추론 분야는 우수하나 작업 기억과 처리 속도에서 보완이 필요합니다.</p>
          <p>추천 학습: 숫자 외우기 및 기호 찾기 훈련을 꾸준히 해보세요.</p>
        </div>
    </section>

    <!-- 📋 검사 결과 목록 -->
    <section class="section">
      <h2 class="section-title">검사 결과 목록</h2>

      <div class="filter-bar" role="search">
        <select aria-label="년도 선택">
          <option selected>2025년</option>
          <option>2024년</option>
        </select>
        <select aria-label="월 선택">
          <option>전체 월</option>
          <option>1월</option>
          <option>2월</option>
          <option>3월</option>
        </select>
        <select aria-label="정렬 기준 선택">
          <option>최신순</option>
          <option>과거순</option>
        </select>
        <button type="button">검색</button>
      </div>

      <div class="results-list">
        <article class="result-entry">
          <div class="card-left">
            <div class="tags">
              <span class="badge badge-strong">강점: 지각 추론</span>
              <span class="badge badge-weak">약점: 작업 기억</span>
            </div>
            <div class="score">총점: 85점</div>
          </div>
          <div class="card-right">
            <time class="datetime" datetime="2025-05-10">2025년 5월 10일</time>
            <a href="#" class="btn-detail" aria-label="2025년 5월 10일 검사 상세 보기">상세 보기</a>
          </div>
        </article>

        <article class="result-entry">
          <div class="card-left">
            <div class="tags">
              <span class="badge badge-strong">강점: 언어 이해</span>
              <span class="badge badge-weak">약점: 공간 지각력</span>
            </div>
            <div class="score">총점: 78점</div>
          </div>
          <div class="card-right">
            <time class="datetime" datetime="2025-04-25">2025년 4월 25일</time>
            <a href="#" class="btn-detail" aria-label="2025년 4월 25일 검사 상세 보기">상세 보기</a>
          </div>
        </article>

        <article class="result-entry">
          <div class="card-left">
            <div class="tags">
              <span class="badge badge-strong">강점: 시사 상식</span>
              <span class="badge badge-weak">약점: 처리 속도</span>
            </div>
            <div class="score">총점: 82점</div>
          </div>
          <div class="card-right">
            <time class="datetime" datetime="2025-04-10">2025년 4월 10일</time>
            <a href="#" class="btn-detail" aria-label="2025년 4월 10일 검사 상세 보기">상세 보기</a>
          </div>
        </article>
      </div>
    </section>
  </main>
</div>

<!-- 차트 스크립트 -->
<script>
  const scoreData = {
    "언어 이해": 6,
    "시사 상식": 4,
    "지각 추론": 5,
    "작업 기억": 1,
    "처리 속도": 4,
    "공간 지각력": 3
  };
  const scoreLabels = Object.keys(scoreData);
  const scoreValues6 = Object.values(scoreData);

  new Chart(document.getElementById('radarChart'), {
    type: 'radar',
    data: {
      labels: scoreLabels,
      datasets: [{
        label: '검사 점수 (6점 만점 환산)',
        data: scoreValues6,
        backgroundColor: 'rgba(59, 130, 246, 0.2)',
        borderColor: '#3b82f6',
        pointBackgroundColor: '#3b82f6',
        borderWidth: 2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: {
        r: {
          min: 0,
          max: 6,
          ticks: { stepSize: 1, color: '#888' },
          grid: { color: '#ddd' },
          pointLabels: { color: '#333', font: { size: 13 } }
        }
      }
    }
  });

  // 예시 전체 점수 이력 (최대 10건만 보여줌)
  const scoreHistory = [
    { date: '03-01', score: 24 },
    { date: '03-10', score: 24 },
    { date: '03-15', score: 14 },
    { date: '03-20', score: 30 },
    { date: '03-25', score: 25 },
    { date: '04-01', score: 16 },
    { date: '04-10', score: 18 },
    { date: '04-20', score: 21 },
    { date: '05-01', score: 34 },
    { date: '05-10', score: 33 }
    // 10건보다 적어도 상관 없음
  ];

  // 최근 10건만 추출
  const recentData = scoreHistory.slice(-10);
  const labels = recentData.map(item => item.date);
  const data = recentData.map(item => item.score);

  new Chart(document.getElementById('lineChart'), {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: '총점',
        data: data,
        borderColor: '#3b82f6',
        backgroundColor: 'rgba(147, 197, 253, 0.3)',
        // tension: 0.4,
        fill: true,
        pointRadius: 4,
        pointBackgroundColor: '#1e3a8a'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: {
        y: {
          min: 0,
          max: 36,
          ticks: { stepSize: 6, color: '#888' },
          grid: { color: '#eee' }
        },
        x: {
          ticks: { color: '#888' },
          grid: { display: false }
        }
      }
    }
  });

</script>
</body>
</html>
